Create tables

query = "CREATE TABLE IF NOT EXISTS session_library"
query = query + "(artist text, song text, length float, sessionId int, \
itemInSession int, PRIMARY KEY(sessionId, itemInSession))"
try:
    session.execute(query)
except Exception as e:
    print(e)
    
query = "CREATE TABLE IF NOT EXISTS artist_library"
query = query + "(artist text, song text, length float, firstName text, \
lastName text, userId int, sessionId int, PRIMARY KEY(userId, sessionId))"
try:
    session.execute(query)
except Exception as e:
    print(e)
    
query = "CREATE TABLE IF NOT EXISTS user_library"
query = query + "(firstName text, lastName text, length float, song text, \
PRIMARY KEY(song))"
try:
    session.execute(query)
except Exception as e:
    print(e)
    
Insert Values

# We have provided part of the code to set up the CSV file. Please complete the Apache Cassandra code below
file = 'event_datafile_new.csv'

with open(file, encoding = 'utf8') as f:
    csvreader = csv.reader(f)
    next(csvreader) # skip header
    for line in csvreader:
## TO-DO: Assign the INSERT statements into the `query` variable
        query = "INSERT INTO session_library artist, song, length, sessionId, itemInSession"
        query = query + "VALUES (%s, %s, %s, %s, %s);"
        ## TO-DO: Assign which column element should be assigned for each column in the INSERT statement.
        ## For e.g., to INSERT artist_name and user first_name, you would change the code below to `line[0], line[1]`
        session.execute(query, (line[0], line[9], float(line[5]), int(line[8]), int(line[3])))
        
Error
---------------------------------------------------------------------------
SyntaxException                           Traceback (most recent call last)
<ipython-input-13-e8d313211246> in <module>()
     11         ## TO-DO: Assign which column element should be assigned for each column in the INSERT statement.
     12         ## For e.g., to INSERT artist_name and user first_name, you would change the code below to `line[0], line[1]`
---> 13         session.execute(query, (line[0], line[9], float(line[5]), int(line[8]), int(line[3])))

/opt/conda/lib/python3.6/site-packages/cassandra/cluster.cpython-36m-x86_64-linux-gnu.so in cassandra.cluster.Session.execute (cassandra/cluster.c:38536)()

/opt/conda/lib/python3.6/site-packages/cassandra/cluster.cpython-36m-x86_64-linux-gnu.so in cassandra.cluster.ResponseFuture.result (cassandra/cluster.c:80834)()

SyntaxException: <Error from server: code=2000 [Syntax error in CQL query] message="line 1:28 no viable alternative at input 'artist' (INSERT INTO [session_library] artist...)">
